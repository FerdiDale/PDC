#!/bin/bash

# Direttive

#PBS -q studenti
#PBS -l nodes=8
#PBS -N Hello
#PBS -o Hello.out
#PBS -e Hello.err

NCPU='wc -l < $PBS_NODEFILE'
echo 'This job is allocated on '${NCPU}' cpu(s)'
cat $PBS_NODEFILE

PBS_O_WORKDIR=$PBS_O_HOME/ProvaDirectory

/usr/lib64/openmpi/1.4/gcc/bin/mpicc -o $PBS_O_WORKDIR/Hello $PBS_O_WORKDIR/Hello.c

/usr/lib64/openmpi/1.4/gcc/bin/mpiexec -machinefile $PBS_NODEFILE -np $NCPU $PBS_O_WORKDIR/Hello

